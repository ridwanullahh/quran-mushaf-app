'use client'

import { createContext, useContext, useState, useEffect } from 'react'
import { appConfig } from '@/lib/config'

type Language = 'en' | 'ar' | 'ur' | 'id' | 'tr' | 'fr' | 'es'

interface I18nContextType {
  language: Language
  setLanguage: (language: Language) => void
  t: (key: string, params?: Record<string, string | number>) => string
  isRTL: boolean
  formatNumber: (num: number) => string
  formatDate: (date: Date) => string
  isSupportedLanguage: (lang: string) => boolean
}

const I18nContext = createContext<I18nContextType | undefined>(undefined)

// Simple translation dictionary - in a real app, this would be loaded from files
const translations: Record<Language, Record<string, string>> = {
  en: {
    'app.name': 'Quran Mushaf',
    'app.description': 'Digital Quran with Physical Book Feel',
    'nav.home': 'Home',
    'nav.surahs': 'Surahs',
    'nav.search': 'Search',
    'nav.bookmarks': 'Bookmarks',
    'nav.settings': 'Settings',
    'nav.admin': 'Admin',
    'reading.mushaf': 'Mushaf',
    'reading.list': 'List',
    'reading.translation': 'Translation',
    'reading.tajweed': 'Tajweed',
    'reading.audio': 'Audio',
    'common.loading': 'Loading...',
    'common.error': 'Error',
    'common.retry': 'Retry',
    'common.cancel': 'Cancel',
    'common.save': 'Save',
    'common.edit': 'Edit',
    'common.delete': 'Delete',
    'common.search': 'Search',
    'common.next': 'Next',
    'common.previous': 'Previous',
    'common.page': 'Page',
    'common.surah': 'Surah',
    'common.ayah': 'Ayah',
    'common.juz': 'Juz',
    'surah.al_fatihah': 'The Opening',
    'surah.al_baqarah': 'The Cow',
    'surah.al_imran': 'The Family of Imran',
    'word.analysis': 'Word Analysis',
    'word.morphology': 'Morphology',
    'word.meaning': 'Meaning',
    'word.tafseer': 'Tafseer',
    'admin.title': 'Administration',
    'admin.subtitle': 'Manage your Quran database and settings',
    'admin.content_management': 'Content Management',
    'admin.system_management': 'System Management',
    'admin.total_translations': 'Total Translations',
    'admin.total_tafseer': 'Total Tafseer',
    'admin.total_morphology': 'Total Morphology',
    'admin.active_users': 'Active Users',
    'admin.translations': 'Translations',
    'admin.tafseer': 'Tafseer',
    'admin.morphology': 'Morphology',
    'admin.search': 'Search',
    'admin.users': 'Users',
    'admin.settings': 'Settings',
    'admin.database': 'Database',
    'admin.export': 'Export',
    'admin.translations_desc': 'Manage Quran translations across all languages',
    'admin.tafseer_desc': 'Manage exegesis and commentary for Quranic verses',
    'admin.morphology_desc': 'Manage word analysis and grammatical data',
    'admin.search_desc': 'Search and manage search functionality',
    'admin.users_desc': 'Manage user accounts and permissions',
    'admin.settings_desc': 'Configure application settings',
    'admin.database_desc': 'Manage database connections and data',
    'admin.export_desc': 'Export data and generate reports',
    'common.manage': 'Manage',
    // Additional admin translations
    'admin.confirm_delete': 'Are you sure you want to delete this item?',
    'admin.translations_management': 'Translations Management',
    'admin.edit_translation': 'Edit Translation',
    'admin.add_translation': 'Add Translation',
    'admin.surah': 'Surah',
    'admin.select_surah': 'Select Surah',
    'admin.ayah': 'Ayah',
    'admin.ayah_number': 'Ayah Number',
    'admin.translation_text': 'Translation Text',
    'admin.enter_translation': 'Enter translation text',
    'admin.translator': 'Translator',
    'admin.translator_name': 'Translator Name',
    'admin.language': 'Language',
    'admin.confidence_score': 'Confidence Score',
    'admin.notes': 'Notes',
    'admin.additional_notes': 'Additional notes...',
    'admin.search_translations': 'Search translations...',
    'admin.filter_surah': 'Filter by Surah',
    'admin.all_surahs': 'All Surahs',
    'admin.surah_ayah': 'Surah:Ayah',
    'admin.arabic_text': 'Arabic Text',
    'admin.translation_preview': 'Translation Preview',
    'admin.translator_name': 'Translator Name',
    'admin.confidence': 'Confidence',
    'admin.actions': 'Actions',
    'admin.no_translations_found': 'No translations found',
    'admin.tafseer_management': 'Tafseer Management',
    'admin.edit_tafseer': 'Edit Tafseer',
    'admin.add_tafseer': 'Add Tafseer',
    'admin.content': 'Content',
    'admin.source': 'Source',
    'admin.details': 'Details',
    'admin.tafseer_text': 'Tafseer Text',
    'admin.enter_tafseer': 'Enter tafseer text',
    'admin.tafseer_type': 'Tafseer Type',
    'admin.exegesis': 'Exegesis',
    'admin.commentary': 'Commentary',
    'admin.explanation': 'Explanation',
    'admin.interpretation': 'Interpretation',
    'admin.verse_meaning': 'Verse Meaning',
    'admin.tafseer_source': 'Tafseer Source',
    'admin.select_tafseer_source': 'Select tafseer source',
    'admin.scholar': 'Scholar',
    'admin.scholar_name': 'Scholar Name',
    'admin.references': 'References',
    'admin.references_placeholder': 'References...',
    'admin.search_tafseer': 'Search tafseer...',
    'admin.filter_type': 'Filter by Type',
    'admin.all_types': 'All Types',
    'admin.tafseer_preview': 'Tafseer Preview',
    'admin.type': 'Type',
    'admin.no_tafseer_found': 'No tafseer found',
    'admin.morphology_management': 'Morphology Management',
    'admin.edit_morphology': 'Edit Morphology',
    'admin.add_morphology': 'Add Morphology',
    'admin.word_info': 'Word Info',
    'admin.grammar': 'Grammar',
    'admin.word_position': 'Word Position',
    'admin.word_position_placeholder': 'Word position in ayah',
    'admin.arabic_word': 'Arabic Word',
    'admin.root': 'Root',
    'admin.transliteration': 'Transliteration',
    'admin.morphology_analysis': 'Morphology Analysis',
    'admin.grammar_type': 'Grammar Type',
    'admin.noun': 'Noun',
    'admin.verb': 'Verb',
    'admin.adjective': 'Adjective',
    'admin.adverb': 'Adverb',
    'admin.preposition': 'Preposition',
    'admin.particle': 'Particle',
    'admin.pronoun': 'Pronoun',
    'admin.conjunction': 'Conjunction',
    'admin.tense_mood': 'Tense/Mood',
    'admin.select_tense_mood': 'Select tense/mood',
    'admin.none': 'None',
    'admin.present': 'Present',
    'admin.past': 'Past',
    'admin.future': 'Future',
    'admin.imperative': 'Imperative',
    'admin.subjunctive': 'Subjunctive',
    'admin.jussive': 'Jussive',
    'admin.person': 'Person',
    'admin.select_person': 'Select person',
    'admin.first': 'First',
    'admin.second': 'Second',
    'admin.third': 'Third',
    'admin.number': 'Number',
    'admin.select_number': 'Select number',
    'admin.singular': 'Singular',
    'admin.dual': 'Dual',
    'admin.plural': 'Plural',
    'admin.gender': 'Gender',
    'admin.select_gender': 'Select gender',
    'admin.masculine': 'Masculine',
    'admin.feminine': 'Feminine',
    'admin.common': 'Common',
    'admin.case': 'Case',
    'admin.select_case': 'Select case',
    'admin.nominative': 'Nominative',
    'admin.accusative': 'Accusative',
    'admin.genitive': 'Genitive',
    'admin.etymology': 'Etymology',
    'admin.etymology_placeholder': 'Etymology...',
    'admin.semantic_field': 'Semantic Field',
    'admin.semantic_field_placeholder': 'Semantic field...',
    'admin.linguistic_notes': 'Linguistic Notes',
    'admin.linguistic_notes_placeholder': 'Linguistic notes...',
    'admin.search_morphology': 'Search morphology...',
    'admin.filter_grammar': 'Filter by Grammar',
    'admin.filter_root': 'Filter by Root',
    'admin.all_roots': 'All Roots',
    'admin.word': 'Word',
    'admin.morphology': 'Morphology',
    'admin.context': 'Context',
    'admin.no_morphology_found': 'No morphology found'
  },
  ar: {
    'app.name': 'مصحف القرآن',
    'app.description': 'القرآن الرقمي بشعور الكتاب المادي',
    'nav.home': 'الرئيسية',
    'nav.surahs': 'السور',
    'nav.search': 'البحث',
    'nav.bookmarks': 'المفضلة',
    'nav.settings': 'الإعدادات',
    'nav.admin': 'الإدارة',
    'reading.mushaf': 'المصحف',
    'reading.list': 'القائمة',
    'reading.translation': 'الترجمة',
    'reading.tajweed': 'التجويد',
    'reading.audio': 'الصوت',
    'common.loading': 'جاري التحميل...',
    'common.error': 'خطأ',
    'common.retry': 'إعادة المحاولة',
    'common.cancel': 'إلغاء',
    'common.save': 'حفظ',
    'common.edit': 'تعديل',
    'common.delete': 'حذف',
    'common.search': 'بحث',
    'common.next': 'التالي',
    'common.previous': 'السابق',
    'common.page': 'صفحة',
    'common.surah': 'سورة',
    'common.ayah': 'آية',
    'common.juz': 'جزء',
    'surah.al_fatihah': 'الفاتحة',
    'surah.al_baqadah': 'البقرة',
    'surah.al_imran': 'آل عمران',
    'word.analysis': 'تحليل الكلمة',
    'word.morphology': 'الصرف',
    'word.meaning': 'المعنى',
    'word.tafseer': 'التفسير',
    'admin.title': 'الإدارة',
    'admin.subtitle': 'إدارة قاعدة بيانات القرآن والإعدادات',
    'admin.content_management': 'إدارة المحتوى',
    'admin.system_management': 'إدارة النظام',
    'admin.total_translations': 'إجمالي الترجمات',
    'admin.total_tafseer': 'إجمالي التفاسير',
    'admin.total_morphology': 'إجمالي التحليل الصرف',
    'admin.active_users': 'المستخدمون النشطون',
    'admin.translations': 'الترجمات',
    'admin.tafseer': 'التفسير',
    'admin.morphology': 'التحليل الصرف',
    'admin.search': 'البحث',
    'admin.users': 'المستخدمون',
    'admin.settings': 'الإعدادات',
    'admin.database': 'قاعدة البيانات',
    'admin.export': 'التصدير',
    'admin.translations_desc': 'إدارة ترجمات القرآن بجميع اللغات',
    'admin.tafseer_desc': 'إدارة التفسير وشروحات الآيات',
    'admin.morphology_desc': 'إدارة تحليل الكلمات والبيانات النحوية',
    'admin.search_desc': 'البحث وإدارة وظائف البحث',
    'admin.users_desc': 'إدارة حسابات المستخدمين والصلاحيات',
    'admin.settings_desc': 'تكوين إعدادات التطبيق',
    'admin.database_desc': 'إدارة اتصالات قاعدة البيانات والبيانات',
    'admin.export_desc': 'تصدير البيانات وإنشاء التقارير',
    'common.manage': 'إدارة',
    // Additional admin translations
    'admin.confirm_delete': 'هل أنت متأكد من أنك تريد حذف هذا العنصر؟',
    'admin.translations_management': 'إدارة الترجمات',
    'admin.edit_translation': 'تحرير الترجمة',
    'admin.add_translation': 'إضافة ترجمة',
    'admin.surah': 'السورة',
    'admin.select_surah': 'اختر السورة',
    'admin.ayah': 'الآية',
    'admin.ayah_number': 'رقم الآية',
    'admin.translation_text': 'نص الترجمة',
    'admin.enter_translation': 'أدخل نص الترجمة',
    'admin.translator': 'المترجم',
    'admin.translator_name': 'اسم المترجم',
    'admin.language': 'اللغة',
    'admin.confidence_score': 'درجة الثقة',
    'admin.notes': 'ملاحظات',
    'admin.additional_notes': 'ملاحظات إضافية...',
    'admin.search_translations': 'البحث في الترجمات...',
    'admin.filter_surah': 'تصفية حسب السورة',
    'admin.all_surahs': 'جميع السور',
    'admin.surah_ayah': 'السورة:الآية',
    'admin.arabic_text': 'النص العربي',
    'admin.translation_preview': 'معاينة الترجمة',
    'admin.translator_name': 'اسم المترجم',
    'admin.confidence': 'الثقة',
    'admin.actions': 'الإجراءات',
    'admin.no_translations_found': 'لم يتم العثور على ترجمات',
    'admin.tafseer_management': 'إدارة التفسير',
    'admin.edit_tafseer': 'تحرير التفسير',
    'admin.add_tafseer': 'إضافة تفسير',
    'admin.content': 'المحتوى',
    'admin.source': 'المصدر',
    'admin.details': 'التفاصيل',
    'admin.tafseer_text': 'نص التفسير',
    'admin.enter_tafseer': 'أدخل نص التفسير',
    'admin.tafseer_type': 'نوع التفسير',
    'admin.exegesis': 'التفسير',
    'admin.commentary': 'التعليق',
    'admin.explanation': 'الشرح',
    'admin.interpretation': 'التفسير',
    'admin.verse_meaning': 'معنى الآية',
    'admin.tafseer_source': 'مصدر التفسير',
    'admin.select_tafseer_source': 'اختر مصدر التفسير',
    'admin.scholar': 'العالم',
    'admin.scholar_name': 'اسم العالم',
    'admin.references': 'المراجع',
    'admin.references_placeholder': 'المراجع...',
    'admin.search_tafseer': 'البحث في التفسير...',
    'admin.filter_type': 'تصفية حسب النوع',
    'admin.all_types': 'جميع الأنواع',
    'admin.tafseer_preview': 'معاينة التفسير',
    'admin.type': 'النوع',
    'admin.no_tafseer_found': 'لم يتم العثور على تفسير',
    'admin.morphology_management': 'إدارة الصرف',
    'admin.edit_morphology': 'تحرير الصرف',
    'admin.add_morphology': 'إضافة صرف',
    'admin.word_info': 'معلومات الكلمة',
    'admin.grammar': 'النحو',
    'admin.word_position': 'موقع الكلمة',
    'admin.word_position_placeholder': 'موقع الكلمة في الآية',
    'admin.arabic_word': 'الكلمة العربية',
    'admin.root': 'الجذر',
    'admin.transliteration': 'الكتابة اللاتينية',
    'admin.morphology_analysis': 'تحليل الصرف',
    'admin.grammar_type': 'نوع النحو',
    'admin.noun': 'اسم',
    'admin.verb': 'فعل',
    'admin.adjective': 'صفة',
    'admin.adverb': 'ظرف',
    'admin.preposition': 'حرف جر',
    'admin.particle': 'أداة',
    'admin.pronoun': 'ضمير',
    'admin.conjunction': 'أداة عطف',
    'admin.tense_mood': 'الزمن/الحالة',
    'admin.select_tense_mood': 'اختر الزمن/الحالة',
    'admin.none': 'لا يوجد',
    'admin.present': 'مضارع',
    'admin.past': 'ماض',
    'admin.future': 'مستقبل',
    'admin.imperative': 'أمر',
    'admin.subjunctive': 'منصوب',
    'admin.jussive': 'مجزوم',
    'admin.person': 'الشخص',
    'admin.select_person': 'اختر الشخص',
    'admin.first': 'أول',
    'admin.second': 'ثاني',
    'admin.third': 'ثالث',
    'admin.number': 'العدد',
    'admin.select_number': 'اختر العدد',
    'admin.singular': 'مفرد',
    'admin.dual': 'مثنى',
    'admin.plural': 'جمع',
    'admin.gender': 'الجنس',
    'admin.select_gender': 'اختر الجنس',
    'admin.masculine': 'مذكر',
    'admin.feminine': 'مؤنث',
    'admin.common': 'مشترك',
    'admin.case': 'الإعراب',
    'admin.select_case': 'اختر الإعراب',
    'admin.nominative': 'مرفوع',
    'admin.accusative': 'منصوب',
    'admin.genitive': 'مجرور',
    'admin.etymology': 'الأصل',
    'admin.etymology_placeholder': 'الأصل...',
    'admin.semantic_field': 'المجال الدلالي',
    'admin.semantic_field_placeholder': 'المجال الدلالي...',
    'admin.linguistic_notes': 'ملاحظات لغوية',
    'admin.linguistic_notes_placeholder': 'ملاحظات لغوية...',
    'admin.search_morphology': 'البحث في الصرف...',
    'admin.filter_grammar': 'تصفية حسب النحو',
    'admin.filter_root': 'تصفية حسب الجذر',
    'admin.all_roots': 'جميع الجذور',
    'admin.word': 'الكلمة',
    'admin.morphology': 'الصرف',
    'admin.context': 'السياق',
    'admin.no_morphology_found': 'لم يتم العثور على صرف'
  },
  ur: {
    'app.name': 'قرآن مجید',
    'app.description': 'مادی کتاب کے احساس کے ساتھ ڈیجیٹل قرآن',
    'nav.home': 'ہوم',
    'nav.surahs': 'سور',
    'nav.search': 'تلاش',
    'nav.bookmarks': 'بک مارکس',
    'nav.settings': 'سیٹنگز',
    'nav.admin': 'ایڈمن',
    'reading.mushaf': 'مصحف',
    'reading.list': 'فہرست',
    'reading.translation': 'ترجمہ',
    'reading.tajweed': 'تجوید',
    'reading.audio': 'آڈیو',
    'common.loading': 'لوڈ ہو رہا ہے...',
    'common.error': 'خرابی',
    'common.retry': 'دوبارہ کوشش',
    'common.cancel': 'منسوخ',
    'common.save': 'محفوظ کریں',
    'common.edit': 'ترمیم',
    'common.delete': 'حذف',
    'common.search': 'تلاش',
    'common.next': 'اگلا',
    'common.previous': 'پچھلا',
    'common.page': 'صفحہ',
    'common.surah': 'سورہ',
    'common.ayah': 'آیت',
    'common.juz': 'جزو',
    'surah.al_fatihah': 'الفاتحہ',
    'surah.al_baqadah': 'بقرہ',
    'surah.al_imran': 'آل عمران',
    'word.analysis': 'لفظ کا تجزیہ',
    'word.morphology': 'صرف',
    'word.meaning': 'معنی',
    'word.tafseer': 'تفسیر',
    'admin.title': 'ایڈمن',
    'admin.subtitle': 'اپنے قرآن ڈیٹابیس اور سیٹنگز کو مینیج کریں',
    'admin.content_management': 'کنٹنٹ مینیجمنٹ',
    'admin.system_management': 'سسٹم مینیجمنٹ',
    'admin.total_translations': 'کل ترجمے',
    'admin.total_tafseer': 'کل تفسیر',
    'admin.total_morphology': 'کل صرف تجزیہ',
    'admin.active_users': 'فعال صارفین',
    'admin.translations': 'ترجمے',
    'admin.tafseer': 'تفسیر',
    'admin.morphology': 'صرف تجزیہ',
    'admin.search': 'تلاش',
    'admin.users': 'صارفین',
    'admin.settings': 'سیٹنگز',
    'admin.database': 'ڈیٹابیس',
    'admin.export': 'ایکسپورٹ',
    'admin.translations_desc': 'تمام زبانوں میں قرآنی ترجموں کو مینیج کریں',
    'admin.tafseer_desc': 'قرآنی آیات کے لیے تفسیر اور شروحات کو مینیج کریں',
    'admin.morphology_desc': 'لفظ تجزیہ اور گرامر ڈیٹا کو مینیج کریں',
    'admin.search_desc': 'تلاش کی فعالیت کو تلاش اور مینیج کریں',
    'admin.users_desc': 'صارف اکاؤنٹس اور اجازتوں کو مینیج کریں',
    'admin.settings_desc': 'ایپلیکیشن سیٹنگز کنفیگر کریں',
    'admin.database_desc': 'ڈیٹابیس کنکشنز اور ڈیٹا کو مینیج کریں',
    'admin.export_desc': 'ڈیٹا ایکسپورٹ کریں اور رپورٹس بنائیں',
    'common.manage': 'مینیج'
  },
  id: {
    'app.name': 'Al-Qur\'an Mushaf',
    'app.description': 'Al-Qur\'an Digital dengan Rasa Buku Fisik',
    'nav.home': 'Beranda',
    'nav.surahs': 'Surah',
    'nav.search': 'Cari',
    'nav.bookmarks': 'Markah',
    'nav.settings': 'Pengaturan',
    'nav.admin': 'Admin',
    'reading.mushaf': 'Mushaf',
    'reading.list': 'Daftar',
    'reading.translation': 'Terjemahan',
    'reading.tajweed': 'Tajwid',
    'reading.audio': 'Audio',
    'common.loading': 'Memuat...',
    'common.error': 'Error',
    'common.retry': 'Coba Lagi',
    'common.cancel': 'Batal',
    'common.save': 'Simpan',
    'common.edit': 'Edit',
    'common.delete': 'Hapus',
    'common.search': 'Cari',
    'common.next': 'Berikut',
    'common.previous': 'Sebelumnya',
    'common.page': 'Halaman',
    'common.surah': 'Surah',
    'common.ayah': 'Ayat',
    'common.juz': 'Juz',
    'surah.al_fatihah': 'Al-Fatihah',
    'surah.al_baqadah': 'Al-Baqarah',
    'surah.al_imran': 'Al-Imran',
    'word.analysis': 'Analisis Kata',
    'word.morphology': 'Morfologi',
    'word.meaning': 'Makna',
    'word.tafseer': 'Tafsir',
    'admin.title': 'Administrasi',
    'admin.subtitle': 'Kelola database Al-Qur\'an dan pengaturan Anda',
    'admin.content_management': 'Manajemen Konten',
    'admin.system_management': 'Manajemen Sistem',
    'admin.total_translations': 'Total Terjemahan',
    'admin.total_tafseer': 'Total Tafsir',
    'admin.total_morphology': 'Total Morfologi',
    'admin.active_users': 'Pengguna Aktif',
    'admin.translations': 'Terjemahan',
    'admin.tafseer': 'Tafsir',
    'admin.morphology': 'Morfologi',
    'admin.search': 'Pencarian',
    'admin.users': 'Pengguna',
    'admin.settings': 'Pengaturan',
    'admin.database': 'Database',
    'admin.export': 'Ekspor',
    'admin.translations_desc': 'Kelola terjemahan Al-Qur\'an di semua bahasa',
    'admin.tafseer_desc': 'Kelola penafsiran dan komentar ayat-ayat Al-Qur\'an',
    'admin.morphology_desc': 'Kelola analisis kata dan data tata bahasa',
    'admin.search_desc': 'Cari dan kelola fungsi pencarian',
    'admin.users_desc': 'Kelola akun pengguna dan izin',
    'admin.settings_desc': 'Konfigurasi pengaturan aplikasi',
    'admin.database_desc': 'Kelola koneksi database dan data',
    'admin.export_desc': 'Ekspor data dan buat laporan',
    'common.manage': 'Kelola'
  },
  tr: {
    'app.name': 'Kuran Mushaf',
    'app.description': 'Fiziksel Kitap Hissiyatı ile Dijital Kuran',
    'nav.home': 'Ana Sayfa',
    'nav.surahs': 'Sureler',
    'nav.search': 'Ara',
    'nav.bookmarks': 'Yer İmleri',
    'nav.settings': 'Ayarlar',
    'nav.admin': 'Yönetici',
    'reading.mushaf': 'Mushaf',
    'reading.list': 'Liste',
    'reading.translation': 'Çeviri',
    'reading.tajweed': 'Tecvid',
    'reading.audio': 'Ses',
    'common.loading': 'Yükleniyor...',
    'common.error': 'Hata',
    'common.retry': 'Tekrar Dene',
    'common.cancel': 'İptal',
    'common.save': 'Kaydet',
    'common.edit': 'Düzenle',
    'common.delete': 'Sil',
    'common.search': 'Ara',
    'common.next': 'Sonraki',
    'common.previous': 'Önceki',
    'common.page': 'Sayfa',
    'common.surah': 'Sure',
    'common.ayah': 'Ayet',
    'common.juz': 'Cüz',
    'surah.al_fatihah': 'Fatiha',
    'surah.al_baqadah': 'Bakara',
    'surah.al_imran': 'İmran',
    'word.analysis': 'Kelime Analizi',
    'word.morphology': 'Morfoloji',
    'word.meaning': 'Anlam',
    'word.tafseer': 'Tefsir',
    'admin.title': 'Yönetim',
    'admin.subtitle': 'Kuran veritabanınızı ve ayarlarınızı yönetin',
    'admin.content_management': 'İçerik Yönetimi',
    'admin.system_management': 'Sistem Yönetimi',
    'admin.total_translations': 'Toplam Çeviriler',
    'admin.total_tafseer': 'Toplam Tefsir',
    'admin.total_morphology': 'Toplam Morfoloji',
    'admin.active_users': 'Aktif Kullanıcılar',
    'admin.translations': 'Çeviriler',
    'admin.tafseer': 'Tefsir',
    'admin.morphology': 'Morfoloji',
    'admin.search': 'Arama',
    'admin.users': 'Kullanıcılar',
    'admin.settings': 'Ayarlar',
    'admin.database': 'Veritabanı',
    'admin.export': 'Dışa Aktar',
    'admin.translations_desc': 'Tüm dillerde Kuran çevirilerini yönetin',
    'admin.tafseer_desc': 'Kuran ayetleri için yorum ve açıklamaları yönetin',
    'admin.morphology_desc': 'Kelime analizi ve dil bilgisi verilerini yönetin',
    'admin.search_desc': 'Arama işlevini arayın ve yönetin',
    'admin.users_desc': 'Kullanıcı hesaplarını ve izinleri yönetin',
    'admin.settings_desc': 'Uygulama ayarlarını yapılandırın',
    'admin.database_desc': 'Veritabanı bağlantılarını ve verileri yönetin',
    'admin.export_desc': 'Verileri dışa aktarın ve raporlar oluşturun',
    'common.manage': 'Yönet'
  },
  fr: {
    'app.name': 'Coran Mushaf',
    'app.description': 'Coran Numérique avec la Sensation du Livre Physique',
    'nav.home': 'Accueil',
    'nav.surahs': 'Sourates',
    'nav.search': 'Rechercher',
    'nav.bookmarks': 'Signets',
    'nav.settings': 'Paramètres',
    'nav.admin': 'Admin',
    'reading.mushaf': 'Mushaf',
    'reading.list': 'Liste',
    'reading.translation': 'Traduction',
    'reading.tajweed': 'Tajwid',
    'reading.audio': 'Audio',
    'common.loading': 'Chargement...',
    'common.error': 'Erreur',
    'common.retry': 'Réessayer',
    'common.cancel': 'Annuler',
    'common.save': 'Sauvegarder',
    'common.edit': 'Modifier',
    'common.delete': 'Supprimer',
    'common.search': 'Rechercher',
    'common.next': 'Suivant',
    'common.previous': 'Précédent',
    'common.page': 'Page',
    'common.surah': 'Sourate',
    'common.ayah': 'Verset',
    'common.juz': 'Juz',
    'surah.al_fatihah': 'Al-Fatiha',
    'surah.al_baqadah': 'Al-Baqarah',
    'surah.al_imran': 'Al-Imran',
    'word.analysis': 'Analyse des Mots',
    'word.morphology': 'Morphologie',
    'word.meaning': 'Sens',
    'word.tafseer': 'Exégèse',
    'admin.title': 'Administration',
    'admin.subtitle': 'Gérez votre base de données du Coran et vos paramètres',
    'admin.content_management': 'Gestion du Contenu',
    'admin.system_management': 'Gestion du Système',
    'admin.total_translations': 'Traductions Totales',
    'admin.total_tafseer': 'Exégèses Totales',
    'admin.total_morphology': 'Morphologies Totales',
    'admin.active_users': 'Utilisateurs Actifs',
    'admin.translations': 'Traductions',
    'admin.tafseer': 'Exégèse',
    'admin.morphology': 'Morphologie',
    'admin.search': 'Recherche',
    'admin.users': 'Utilisateurs',
    'admin.settings': 'Paramètres',
    'admin.database': 'Base de Données',
    'admin.export': 'Exporter',
    'admin.translations_desc': 'Gérez les traductions du Coran dans toutes les langues',
    'admin.tafseer_desc': 'Gérez l\'exégèse et les commentaires des versets coraniques',
    'admin.morphology_desc': 'Gérez l\'analyse des mots et les données grammaticales',
    'admin.search_desc': 'Recherchez et gérez la fonction de recherche',
    'admin.users_desc': 'Gérez les comptes d\'utilisateurs et les autorisations',
    'admin.settings_desc': 'Configurez les paramètres de l\'application',
    'admin.database_desc': 'Gérez les connexions de base de données et les données',
    'admin.export_desc': 'Exportez les données et créez des rapports',
    'common.manage': 'Gérer'
  },
  es: {
    'app.name': 'Corán Mushaf',
    'app.description': 'Corán Digital con la Sensación del Libro Físico',
    'nav.home': 'Inicio',
    'nav.surahs': 'Surahs',
    'nav.search': 'Buscar',
    'nav.bookmarks': 'Marcadores',
    'nav.settings': 'Configuración',
    'nav.admin': 'Admin',
    'reading.mushaf': 'Mushaf',
    'reading.list': 'Lista',
    'reading.translation': 'Traducción',
    'reading.tajweed': 'Tajwíd',
    'reading.audio': 'Audio',
    'common.loading': 'Cargando...',
    'common.error': 'Error',
    'common.retry': 'Reintentar',
    'common.cancel': 'Cancelar',
    'common.save': 'Guardar',
    'common.edit': 'Editar',
    'common.delete': 'Eliminar',
    'common.search': 'Buscar',
    'common.next': 'Siguiente',
    'common.previous': 'Anterior',
    'common.page': 'Página',
    'common.surah': 'Surah',
    'common.ayah': 'Verso',
    'common.juz': 'Yuz',
    'surah.al_fatihah': 'Al-Fatiha',
    'surah.al_baqadah': 'Al-Baqarah',
    'surah.al_imran': 'Al-Imran',
    'word.analysis': 'Análisis de Palabras',
    'word.morphology': 'Morfología',
    'word.meaning': 'Significado',
    'word.tafseer': 'Exégesis',
    'admin.title': 'Administración',
    'admin.subtitle': 'Gestione su base de datos del Corán y configuraciones',
    'admin.content_management': 'Gestión de Contenido',
    'admin.system_management': 'Gestión del Sistema',
    'admin.total_translations': 'Total Traducciones',
    'admin.total_tafseer': 'Total Exégesis',
    'admin.total_morphology': 'Total Morfología',
    'admin.active_users': 'Usuarios Activos',
    'admin.translations': 'Traducciones',
    'admin.tafseer': 'Exégesis',
    'admin.morphology': 'Morfología',
    'admin.search': 'Búsqueda',
    'admin.users': 'Usuarios',
    'admin.settings': 'Configuración',
    'admin.database': 'Base de Datos',
    'admin.export': 'Exportar',
    'admin.translations_desc': 'Gestione las traducciones del Corán en todos los idiomas',
    'admin.tafseer_desc': 'Gestione la exégesis y comentarios de los versículos coránicos',
    'admin.morphology_desc': 'Gestione el análisis de palabras y datos gramaticales',
    'admin.search_desc': 'Busque y gestione la función de búsqueda',
    'admin.users_desc': 'Gestione las cuentas de usuario y permisos',
    'admin.settings_desc': 'Configure los ajustes de la aplicación',
    'admin.database_desc': 'Gestione las conexiones de base de datos y datos',
    'admin.export_desc': 'Exporte datos y cree informes',
    'common.manage': 'Gestionar'
  }
}

export function I18nProvider({ children }: { children: React.ReactNode }) {
  const [language, setLanguage] = useState<Language>(() => {
    // Get language from localStorage or default (only in browser)
    if (typeof window !== 'undefined') {
      const savedLanguage = localStorage.getItem('quran-language') as Language
      return savedLanguage || (appConfig.i18n.defaultLanguage as Language)
    }
    return appConfig.i18n.defaultLanguage as Language
  })

  const isRTL = language === 'ar'

  // Update document language and direction
  useEffect(() => {
    if (typeof window !== 'undefined') {
      document.documentElement.lang = language
      document.documentElement.dir = isRTL ? 'rtl' : 'ltr'
      localStorage.setItem('quran-language', language)
    }
  }, [language, isRTL])

  // Listen for language changes in other tabs
  useEffect(() => {
    const handleStorageChange = (e: StorageEvent) => {
      if (e.key === 'quran-language' && e.newValue) {
        setLanguage(e.newValue as Language)
      }
    }

    window.addEventListener('storage', handleStorageChange)
    return () => window.removeEventListener('storage', handleStorageChange)
  }, [])

  const t = (key: string, params?: Record<string, string | number>): string => {
    let translation = translations[language][key] || translations.en[key] || key
    
    // Replace parameters
    if (params) {
      Object.entries(params).forEach(([param, value]) => {
        translation = translation.replace(`{{${param}}}`, value.toString())
      })
    }
    
    return translation
  }

  const formatNumber = (num: number): string => {
    if (language === 'ar') {
      // Convert to Arabic numerals
      const arabicNumerals = ['٠', '١', '٢', '٣', '٤', '٥', '٦', '٧', '٨', '٩']
      return num.toString().split('').map(digit => arabicNumerals[parseInt(digit)]).join('')
    }
    return num.toLocaleString(language)
  }

  const formatDate = (date: Date): string => {
    return date.toLocaleDateString(language, {
      year: 'numeric',
      month: 'long',
      day: 'numeric'
    })
  }

  const isSupportedLanguage = (lang: string): boolean => {
    return appConfig.i18n.supportedLanguages.includes(lang)
  }

  const value: I18nContextType = {
    language,
    setLanguage,
    t,
    isRTL,
    formatNumber,
    formatDate,
    isSupportedLanguage
  }

  return (
    <I18nContext.Provider value={value}>
      {children}
    </I18nContext.Provider>
  )
}

export function useI18n() {
  const context = useContext(I18nContext)
  if (context === undefined) {
    throw new Error('useI18n must be used within an I18nProvider')
  }
  return context
}

// Alias for useTranslation (used in some components)
export function useTranslation() {
  const context = useContext(I18nContext)
  if (context === undefined) {
    throw new Error('useTranslation must be used within an I18nProvider')
  }
  return { t: context.t }
}